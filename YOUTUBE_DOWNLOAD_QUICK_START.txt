# YouTube Download System - Quick Start

## Setup (One-time)

1. Install yt-dlp:
   Ubuntu: sudo wget https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp -O /usr/local/bin/yt-dlp && sudo chmod +x /usr/local/bin/yt-dlp
   macOS: brew install yt-dlp

2. Install ffmpeg:
   Ubuntu: sudo apt install ffmpeg -y
   macOS: brew install ffmpeg

3. Create S3 bucket: klass-vr-videos (or your name)

4. Add to .env:
   AWS_S3_BUCKET=klass-vr-videos

5. Deploy:
   git push origin main
   ssh to server
   git pull && npm install
   pm2 restart app

## Usage

### Create content with YouTube URL:
POST /v1/content
{
  "youTubeUrl": "https://youtu.be/VIDEO_ID",
  "sessionId": "...",
  ...
}

→ Returns: { youTubeDownloadStatus: "pending" }

### Check status:
GET /v1/youtube-download/status/:contentId

→ Returns: { downloadStatus: "completed", downloadedUrl: "https://s3..." }

### Use in Unity:
videoPlayer.url = content.youTubeDownloadedUrl;

## Status Flow
pending → downloading → downloaded → uploading → completed ✅
                                                  ↓
                                               failed ❌

## Endpoints
- POST /v1/content - Auto-triggers download
- PATCH /v1/content/:id - Auto-triggers download if URL changed
- GET /v1/youtube-download/status/:contentId - Check specific video
- GET /v1/youtube-download/queue - Check queue status

## Costs
~$5/month for 100 videos with moderate usage (AWS S3)

## Troubleshooting
- Check logs: pm2 logs app | grep YouTube
- Install missing: yt-dlp, ffmpeg
- AWS credentials: Check .env
- Bot errors: Add YOUTUBE_COOKIE=chrome to .env
